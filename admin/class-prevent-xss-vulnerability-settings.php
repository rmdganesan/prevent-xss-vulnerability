<?php
/**
 * @package PreventXSSVulnerability\Admin
 */

class Prevent_XSS_Vulnerability_Settings {

  /**
   * Call XSS Settings Function.
   */
  function __construct() {
    $this->xss_settings();
  }

  /**
   * Define what plugin can do
   *
   * @access private
   * @since 0.1
   *
   * @return void
   */
  private function xss_settings() {
    $plugin_url = plugins_url( '/admin', PREVENT_XSS_VULNERABILITY_FILE );
    wp_enqueue_style( 'style', $plugin_url . '/css/admin-style.min.css' );
    ?>
    <div class="wrap">
      <h2><?php _e( 'Cross-site scripting', 'prevent-xss-vulnerability' ); ?></h2>
      <table class="important">
        <tr>
          <td class="icon"><i class="fa icon icon-important" title="important">&nbsp;</i></td>
          <td>
            <p><?php _e( 'After Configuring the Settings Please check the pages randomly to verify that your site is working properly.', 'prevent-xss-vulnerability' ); ?></p>
            <p><?php _e( 'If you are running <strong>WooCommerce</strong> Site so, please go through with all the steps of the Product Purchase (Cart, Checkout etc) to make sure that your Products can be purchased without having any diffuclty to customers.', 'prevent-xss-vulnerability' ); ?></p>
          </td>
        </tr>
      </table>

      <div>
        <p><?php _e( 'Cross-site scripting (XSS) is a type of computer security vulnerability typically found in web applications. XSS enables attackers to inject client-side scripts into web pages viewed by other users. A cross-site scripting vulnerability may be used by attackers to bypass access controls such as the same-origin policy.', 'prevent-xss-vulnerability' ); ?></p>
        <p><?php _e( 'Cross-site scripting carried out on websites accounted for roughly <strong>84%</strong> of all security vulnerabilities documented by Symantec as of <em>2007</em>. <strong>Bug bounty company HackerOne</strong> in <em>2017</em> reported that XSS is still a major threat vector. XSS effects vary in range from petty nuisance to significant security risk, depending on the sensitivity of the data handled by the vulnerable site and the nature of any security mitigation implemented by the site\'s owner.', 'prevent-xss-vulnerability' ); ?></p>
      </div>

      <h3 id="reflected-cross-site-scripting"><?php _e( 'Reflected Cross-site Scripting', 'prevent-xss-vulnerability' ); ?></h3>
      <div>
        <p><?php _e( 'The non-persistent (or reflected) cross-site scripting vulnerability is by far the most basic type of web vulnerability. These holes show up when the data provided by a web client, most commonly in HTTP query parameters (e.g. HTML form submission), is used immediately by server-side scripts to parse and display a page of results for and to that user, without properly sanitizing the request.', 'prevent-xss-vulnerability' ); ?></p>
        <p><?php _e( 'A reflected attack is typically delivered via email or a neutral web site. The bait is an innocent-looking URL, pointing to a trusted site but containing the XSS vector. If the trusted site is vulnerable to the vector, clicking the link can cause the victim\'s browser to execute the injected script.', 'prevent-xss-vulnerability' ); ?></p>
        <p><?php _e( 'Please make sure to Check the <a href="/wp-admin/admin.php?page=prevent-xss-vulnerability-reflected-settings" title="Reflected XSS">Reflected XSS</a> Settings Page to allow it work.', 'prevent-xss-vulnerability' ); ?></p>
      </div>

      <h3 id="persistent-cross-site-scripting"><?php _e( 'Persistent Cross-site Scripting', 'prevent-xss-vulnerability' ); ?></h3>
      <div>
        <p><?php _e( 'The persistent (or stored) XSS vulnerability is a more devastating variant of a cross-site scripting flaw: it occurs when the data provided by the attacker is saved by the server, and then permanently displayed on "normal" pages returned to other users in the course of regular browsing, without proper HTML escaping. A classic example of this is with online message boards where users are allowed to post HTML formatted messages for other users to read.', 'prevent-xss-vulnerability' ); ?></p>
      </div>

      <h3 id="mutated-cross-site-scripting"><?php _e( 'Mutated Cross-site Scripting', 'prevent-xss-vulnerability' ); ?></h3>
      <div>
        <p><?php _e( 'Mutated XSS happens, when the attacker injects something that is seemingly safe, but rewritten and modified by the browser, while parsing the markup. This makes it extremely hard to detect or sanitize within the websites application logic. An example is rebalancing unclosed quotation marks or even adding quotation marks to unquoted parameters on parameters to CSS font-family.', 'prevent-xss-vulnerability' ); ?></p>
      </div>
    </div>
    <?php
  }
}
